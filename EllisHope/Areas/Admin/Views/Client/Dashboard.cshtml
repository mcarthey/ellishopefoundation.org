@model ClientDashboardViewModel
@{
    ViewData["Title"] = "Client Dashboard";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<div class="row mb-4">
    <div class="col-12">
        <h2>
            <i class="bi bi-person-badge text-info"></i> Client Dashboard
        </h2>
        <p class="text-muted">Welcome back, @Model.ClientName</p>
    </div>
</div>

<!-- Statistics Cards -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="mb-0">Membership Status</h6>
                        <h3 class="mb-0">@Model.Status</h3>
                    </div>
                    <i class="bi bi-check-circle fs-1"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-white h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="mb-0">Member Since</h6>
                        <h3 class="mb-0">@Model.JoinedDate.ToString("MMM yyyy")</h3>
                    </div>
                    <i class="bi bi-calendar-check fs-1"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-info text-white h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="mb-0">Monthly Fee</h6>
                        <h3 class="mb-0">$@Model.MonthlyFee.ToString("N2")</h3>
                    </div>
                    <i class="bi bi-cash-coin fs-1"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-dark h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="mb-0">Days Remaining</h6>
                        <h3 class="mb-0">
                            @if (Model.DaysRemaining.HasValue)
                            {
                                @Model.DaysRemaining.Value
                            }
                            else
                            {
                                <span>N/A</span>
                            }
                        </h3>
                    </div>
                    <i class="bi bi-hourglass-split fs-1"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Membership Progress -->
@if (Model.MembershipStartDate.HasValue && Model.MembershipEndDate.HasValue)
{
    <div class="card mb-4">
        <div class="card-header bg-light">
            <h5 class="mb-0">
                <i class="bi bi-graph-up"></i> Membership Progress
            </h5>
        </div>
        <div class="card-body">
            <div class="mb-3">
                <div class="d-flex justify-content-between mb-2">
                    <span><strong>Start:</strong> @Model.MembershipStartDate.Value.ToString("MMM dd, yyyy")</span>
                    <span><strong>End:</strong> @Model.MembershipEndDate.Value.ToString("MMM dd, yyyy")</span>
                </div>
                <div class="progress" style="height: 30px;">
                    <div class="progress-bar bg-info" role="progressbar" 
                         style="width: @(Model.MembershipProgress?.ToString("F0") ?? "0")%"
                         aria-valuenow="@(Model.MembershipProgress ?? 0)" aria-valuemin="0" aria-valuemax="100">
                        @(Model.MembershipProgress?.ToString("F0") ?? "0")%
                    </div>
                </div>
                <div class="mt-2 text-center text-muted">
                    <small>
                        @if (Model.MembershipDays.HasValue)
                        {
                            <span>@Model.MembershipDays days elapsed</span>
                        }
                        @if (Model.DaysRemaining.HasValue && Model.DaysRemaining > 0)
                        {
                            <span> • @Model.DaysRemaining days remaining</span>
                        }
                    </small>
                </div>
            </div>
        </div>
    </div>
}

<!-- Sponsor Information -->
<div class="row mb-4">
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="bi bi-person-heart"></i> Your Sponsor
                </h5>
            </div>
            <div class="card-body">
                @if (Model.HasSponsor)
                {
                    <h4>@Model.SponsorName</h4>
                    <div class="mt-3">
                        <p class="mb-2">
                            <i class="bi bi-envelope"></i> 
                            <a href="mailto:@Model.SponsorEmail">@Model.SponsorEmail</a>
                        </p>
                        @if (!string.IsNullOrEmpty(Model.SponsorPhone))
                        {
                            <p class="mb-2">
                                <i class="bi bi-phone"></i> 
                                <a href="tel:@Model.SponsorPhone">@Model.SponsorPhone</a>
                            </p>
                        }
                    </div>
                    <div class="alert alert-info mt-3">
                        <small>
                            <i class="bi bi-lightbulb"></i> 
                            Your sponsor is here to support you on your fitness journey. Don't hesitate to reach out!
                        </small>
                    </div>
                }
                else
                {
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i> 
                        You don't have a sponsor assigned yet. Contact the foundation for more information.
                    </div>
                }
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="bi bi-calendar-week"></i> Upcoming Activities
                </h5>
            </div>
            <div class="card-body">
                <div class="alert alert-secondary">
                    <i class="bi bi-info-circle"></i> No upcoming activities scheduled.
                </div>
                <p class="mb-0">
                    <small class="text-muted">
                        Check the <a asp-controller="Event" asp-action="list" asp-area="">Events page</a> to see what's happening at the foundation.
                    </small>
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-graph-up-arrow fs-1 text-primary"></i>
                <h5 class="mt-3">Track Progress</h5>
                <p class="text-muted">View your milestones and achievements</p>
                <a asp-action="Progress" class="btn btn-primary">
                    <i class="bi bi-arrow-right"></i> View Progress
                </a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-person-circle fs-1 text-success"></i>
                <h5 class="mt-3">My Profile</h5>
                <p class="text-muted">View and update your profile</p>
                <a asp-action="MyProfile" class="btn btn-success">
                    <i class="bi bi-arrow-right"></i> Go to Profile
                </a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-book fs-1 text-info"></i>
                <h5 class="mt-3">Resources</h5>
                <p class="text-muted">Access helpful guides and materials</p>
                <a asp-action="Resources" class="btn btn-info">
                    <i class="bi bi-arrow-right"></i> View Resources
                </a>
            </div>
        </div>
    </div>
</div>

@functions {
    private string GetStatusBadgeColor(EllisHope.Models.Domain.MembershipStatus status)
    {
        return status switch
        {
            EllisHope.Models.Domain.MembershipStatus.Active => "success",
            EllisHope.Models.Domain.MembershipStatus.Pending => "warning",
            EllisHope.Models.Domain.MembershipStatus.Inactive => "secondary",
            EllisHope.Models.Domain.MembershipStatus.Expired => "danger",
            EllisHope.Models.Domain.MembershipStatus.Cancelled => "dark",
            _ => "secondary"
        };
    }
}
